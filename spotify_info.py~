'''
Script to output the Song & artist currently playd on spotify.

Intended for usage in my Polybar

Partially stolen from https://stackoverflow.com/questions/33883360/get-spotify-currently-playing-track
'''

import dbus
session_bus = dbus.SessionBus()
spotify_bus = session_bus.get_object("org.mpris.MediaPlayer2.spotify",
                                     "/org/mpris/MediaPlayer2")
spotify_properties = dbus.Interface(spotify_bus,
                                    "org.freedesktop.DBus.Properties")
metadata = spotify_properties.Get("org.mpris.MediaPlayer2.Player", "Metadata")

# The property Metadata behaves like a python dict
for key, value in metadata.items():
    print key, value

# To just print the title
print metadata['xesam:title']
